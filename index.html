<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë‚˜ë§Œì˜ ë¡œë˜ 50 - ì˜¤í† ë§¤í‹± ë§ˆìŠ¤í„°</title>
    <style>
        body { font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, 'Helvetica Neue', 'Segoe UI', 'Apple SD Gothic Neo', 'Noto Sans KR', 'Malgun Gothic', 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', sans-serif; background-color: #eef2f6; margin: 0; padding: 20px; color: #333; }
        .container { max-width: 680px; margin: 0 auto; background: white; padding: 30px; border-radius: 24px; box-shadow: 0 15px 35px rgba(0,0,0,0.08); }
        
        /* í—¤ë” ì˜ì—­ */
        header { text-align: center; margin-bottom: 30px; }
        h1 { margin: 0 0 10px 0; font-size: 1.8rem; color: #1e293b; letter-spacing: -0.5px; }
        .sub-desc { font-size: 0.9rem; color: #64748b; }

        /* ìë™ ì¡°íšŒ ë²„íŠ¼ */
        .control-panel { text-align: center; margin-bottom: 25px; padding-bottom: 25px; border-bottom: 2px dashed #e2e8f0; }
        .btn-fetch {
            background: linear-gradient(135deg, #6366f1, #4f46e5);
            color: white; padding: 14px 32px; border: none; border-radius: 50px;
            font-size: 1.05rem; font-weight: 700; cursor: pointer;
            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3); transition: all 0.2s;
            display: inline-flex; align-items: center; gap: 8px;
        }
        .btn-fetch:hover { transform: translateY(-2px); box-shadow: 0 6px 16px rgba(79, 70, 229, 0.4); }
        .btn-fetch:active { transform: translateY(0); }
        .loading-icon { animation: spin 1s linear infinite; display: none; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* ë‹¹ì²¨ ê²°ê³¼ ëŒ€ì‹œë³´ë“œ */
        .dashboard { background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 20px; padding: 25px; margin-bottom: 30px; position: relative; }
        .badge-round {
            position: absolute; top: -12px; left: 50%; transform: translateX(-50%);
            background: #0f172a; color: #fff; padding: 6px 16px; border-radius: 20px;
            font-size: 0.85rem; font-weight: 700; box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .win-balls { display: flex; justify-content: center; gap: 8px; margin: 20px 0; flex-wrap: wrap; }
        .win-ball {
            width: 44px; height: 44px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-weight: 800; font-size: 1.2rem; color: white;
            box-shadow: inset -3px -3px 6px rgba(0,0,0,0.2);
            position: relative;
        }
        .plus-sign { align-self: center; font-size: 1.5rem; color: #94a3b8; margin: 0 5px; font-weight: 300; }
        
        .info-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-top: 20px; }
        .info-item { background: white; padding: 12px; border-radius: 12px; border: 1px solid #e2e8f0; text-align: center; }
        .info-label { display: block; font-size: 0.8rem; color: #64748b; margin-bottom: 4px; }
        .info-value { font-weight: 700; color: #334155; font-size: 0.95rem; word-break: keep-all; }
        .highlight { color: #e11d48; }

        /* ë‚´ ë²ˆí˜¸ ë¦¬ìŠ¤íŠ¸ */
        .list-header { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 15px; padding: 0 10px; }
        .list-title { font-size: 1.1rem; font-weight: 700; color: #1e293b; }
        .my-total { font-size: 0.95rem; color: #6366f1; font-weight: 700; }

        .lotto-list { display: flex; flex-direction: column; gap: 10px; }
        .lotto-row {
            display: flex; align-items: center; justify-content: space-between;
            padding: 12px 16px; background: white; border-radius: 14px;
            border: 1px solid #f1f5f9; transition: all 0.2s;
        }
        .lotto-row:hover { transform: translateX(5px); border-color: #cbd5e1; }
        
        .row-idx { font-size: 0.8rem; color: #94a3b8; width: 25px; font-weight: 500; }
        
        .my-balls { display: flex; gap: 5px; }
        .my-ball {
            width: 30px; height: 30px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 0.85rem; font-weight: 700; color: #fff;
            background-color: #e2e8f0; color: #94a3b8; /* ê¸°ë³¸ íšŒìƒ‰ */
        }
        
        /* ê³µ ìƒ‰ìƒ í´ë˜ìŠ¤ */
        .b-y { background-color: #fcc419; color: #333; text-shadow: none; }
        .b-b { background-color: #4dabf7; color: #fff; }
        .b-r { background-color: #ff6b6b; color: #fff; }
        .b-g { background-color: #adb5bd; color: #fff; }
        .b-gr { background-color: #69db7c; color: #fff; }

        /* ë‹¹ì²¨ëœ ê³µ ìŠ¤íƒ€ì¼ */
        .my-ball.hit { 
            box-shadow: 0 0 0 2px #1e293b; 
            transform: scale(1.1); z-index: 2; 
        }
        
        /* ë‹¹ì²¨ ë±ƒì§€ */
        .rank-tag {
            padding: 4px 10px; border-radius: 8px; font-size: 0.75rem; font-weight: 800; color: white; min-width: 50px; text-align: center;
        }
        .tag-1 { background: linear-gradient(45deg, #ef4444, #f87171); box-shadow: 0 2px 5px rgba(239, 68, 68, 0.4); }
        .tag-2 { background: linear-gradient(45deg, #f97316, #fb923c); }
        .tag-3 { background: linear-gradient(45deg, #22c55e, #4ade80); }
        .tag-4 { background: linear-gradient(45deg, #0ea5e9, #38bdf8); }
        .tag-5 { background: #94a3b8; }
        .tag-fail { display: none; }

    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>ğŸ€ ë‚˜ë§Œì˜ ë¡œë˜ 50</h1>
        <div class="sub-desc">ë²„íŠ¼ í•œ ë²ˆìœ¼ë¡œ ìµœì‹  ë‹¹ì²¨ ê²°ê³¼ë¥¼ ìë™ ë¶„ì„í•©ë‹ˆë‹¤</div>
    </header>
    
    <div class="control-panel">
        <button class="btn-fetch" onclick="fetchLatestLotto()">
            <span class="loading-icon" id="spinIcon">â³</span>
            <span id="btnText">ìµœì‹  ê²°ê³¼ ìë™ ì¡°íšŒ</span>
        </button>
    </div>

    <div class="dashboard" id="dashboard" style="display:none;">
        <div class="badge-round" id="roundBadge">0000íšŒì°¨</div>
        
        <div class="win-balls" id="winBallsContainer">
            </div>

        <div class="info-grid">
            <div class="info-item">
                <span class="info-label">1ë“± ë‹¹ì²¨ê¸ˆ</span>
                <span class="info-value highlight" id="prizeVal">-</span>
            </div>
            <div class="info-item">
                <span class="info-label">1ë“± ë‹¹ì²¨ì ìˆ˜</span>
                <span class="info-value" id="winnerCount">-</span>
            </div>
            <div class="info-item">
                <span class="info-label">ì¶”ì²¨ì¼</span>
                <span class="info-value" id="drawDate">-</span>
            </div>
            <div class="info-item">
                <span class="info-label">ì¥ì†Œ/ìœ í˜•</span>
                <span class="info-value" style="font-size:0.8rem; color:#94a3b8;">í™ˆí˜ì´ì§€ ì°¸ì¡° (APIë¯¸ì œê³µ)</span>
            </div>
        </div>
    </div>

    <div class="list-header">
        <div class="list-title">ë‚˜ì˜ 50ì„¸íŠ¸ ê²°ê³¼</div>
        <div class="my-total" id="myTotalMoney"></div>
    </div>

    <div class="lotto-list" id="lottoList">
        </div>
</div>

<script>
    // 50ì„¸íŠ¸ ë°ì´í„° (ì•ì„œ ìƒì„±í•œ 3:3 ë°¸ëŸ°ìŠ¤, í•©ê³„ 130~150 ë°ì´í„°)
    const myNumbers = [
        [2, 13, 21, 28, 34, 37], [5, 14, 22, 29, 31, 38], [3, 16, 24, 27, 30, 39], [9, 12, 20, 25, 33, 36], [4, 15, 23, 26, 31, 32],
        [7, 18, 22, 29, 34, 35], [1, 19, 24, 28, 33, 36], [6, 17, 21, 25, 30, 32], [8, 11, 23, 26, 35, 38], [10, 13, 24, 29, 31, 36],
        [2, 15, 20, 27, 33, 34], [5, 16, 22, 25, 30, 39], [4, 18, 23, 29, 31, 36], [7, 12, 21, 28, 35, 38], [9, 14, 26, 27, 32, 33],
        [3, 19, 24, 25, 30, 34], [6, 11, 22, 29, 37, 38], [1, 20, 23, 28, 35, 36], [8, 17, 24, 25, 31, 32], [10, 15, 21, 26, 33, 34],
        [2, 13, 22, 29, 35, 36], [5, 18, 24, 27, 31, 38], [4, 11, 23, 26, 30, 39], [7, 16, 25, 28, 33, 34], [9, 14, 21, 29, 32, 35],
        [3, 20, 22, 27, 31, 36], [6, 15, 24, 25, 30, 38], [1, 12, 26, 29, 33, 34], [8, 19, 21, 28, 35, 36], [10, 17, 23, 24, 32, 39],
        [2, 11, 25, 28, 34, 37], [5, 14, 21, 26, 33, 36], [4, 15, 22, 29, 31, 38], [7, 18, 24, 27, 30, 35], [9, 12, 23, 28, 32, 39],
        [3, 16, 21, 26, 34, 37], [6, 13, 25, 29, 30, 36], [1, 14, 22, 27, 31, 38], [8, 20, 24, 25, 33, 34], [10, 11, 18, 26, 35, 39],
        [2, 15, 23, 30, 34, 41], [5, 12, 21, 28, 36, 43], [4, 17, 24, 29, 31, 40], [7, 14, 22, 25, 38, 39], [9, 16, 26, 27, 33, 34],
        [3, 13, 20, 31, 35, 42], [6, 18, 21, 28, 32, 45], [1, 19, 24, 29, 30, 44], [8, 15, 23, 26, 37, 38], [10, 12, 25, 27, 36, 39]
    ];

    // ê³µ ìƒ‰ìƒ í´ë˜ìŠ¤ ë°˜í™˜
    function getColorClass(num) {
        if (num <= 10) return 'b-y';
        if (num <= 20) return 'b-b';
        if (num <= 30) return 'b-r';
        if (num <= 40) return 'b-g';
        return 'b-gr';
    }

    // íšŒì°¨ ê³„ì‚° (ì˜¤ëŠ˜ ë‚ ì§œ ê¸°ì¤€ ê°€ì¥ ìµœê·¼ í† ìš”ì¼ ì¶”ì²¨íšŒì°¨)
    function calculateRound() {
        const start = new Date('2002-12-07T21:00:00');
        const now = new Date();
        const diff = now - start;
        let round = Math.floor(diff / (1000 * 60 * 60 * 24 * 7)) + 1;
        
        // í† ìš”ì¼ ì €ë… 8ì‹œ 45ë¶„ ì „ì´ë©´ ì•„ì§ ì¶”ì²¨ ì•ˆí•¨ -> ì „ íšŒì°¨ ë³´ì—¬ì£¼ê¸°
        if (now.getDay() === 6 && now.getHours() < 21) {
            if(now.getHours() < 20 || (now.getHours() === 20 && now.getMinutes() < 45)) {
                round--;
            }
        }
        return round;
    }

    // API í˜¸ì¶œ (CORS í”„ë¡ì‹œ ì‚¬ìš©)
    async function fetchLatestLotto() {
        const btnText = document.getElementById('btnText');
        const spinIcon = document.getElementById('spinIcon');
        
        btnText.innerText = "ë°ì´í„° ê°€ì ¸ì˜¤ëŠ” ì¤‘...";
        spinIcon.style.display = "inline-block";

        const round = calculateRound();
        // AllOrigins Proxyë¥¼ í†µí•´ ë™í–‰ë³µê¶Œ API ìš°íšŒ í˜¸ì¶œ
        const url = `https://api.allorigins.win/raw?url=${encodeURIComponent('https://www.dhlottery.co.kr/common.do?method=getLottoNumber&drwNo=' + round)}`;

        try {
            const res = await fetch(url);
            const data = await res.json();

            if (data.returnValue === 'success') {
                renderDashboard(data);
                renderMyList([data.drwtNo1, data.drwtNo2, data.drwtNo3, data.drwtNo4, data.drwtNo5, data.drwtNo6], data.bnusNo);
                btnText.innerText = "ì¡°íšŒ ì™„ë£Œ!";
            } else {
                alert("ì•„ì§ ë‹¹ì²¨ ê²°ê³¼ê°€ ë‚˜ì˜¤ì§€ ì•Šì•˜ê±°ë‚˜ í†µì‹  ì˜¤ë¥˜ì…ë‹ˆë‹¤.");
                btnText.innerText = "ë‹¤ì‹œ ì‹œë„";
            }
        } catch (e) {
            console.error(e);
            alert("ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
            btnText.innerText = "ì˜¤ë¥˜ ë°œìƒ";
        } finally {
            spinIcon.style.display = "none";
        }
    }

    // ìƒë‹¨ ëŒ€ì‹œë³´ë“œ ê·¸ë¦¬ê¸°
    function renderDashboard(data) {
        document.getElementById('dashboard').style.display = 'block';
        document.getElementById('roundBadge').innerText = `${data.drwNo}íšŒ ë‹¹ì²¨ê²°ê³¼`;
        document.getElementById('prizeVal').innerText = parseInt(data.firstWinamnt).toLocaleString() + 'ì›';
        document.getElementById('winnerCount').innerText = data.firstPrzwnerCo + 'ëª…';
        document.getElementById('drawDate').innerText = data.drwNoDate;

        const ballsContainer = document.getElementById('winBallsContainer');
        ballsContainer.innerHTML = '';
        
        const nums = [data.drwtNo1, data.drwtNo2, data.drwtNo3, data.drwtNo4, data.drwtNo5, data.drwtNo6];
        
        nums.forEach(n => {
            const ball = document.createElement('div');
            ball.className = `win-ball ${getColorClass(n)}`;
            ball.innerText = n;
            ballsContainer.appendChild(ball);
        });

        // ë³´ë„ˆìŠ¤
        const plus = document.createElement('div');
        plus.className = 'plus-sign';
        plus.innerText = '+';
        ballsContainer.appendChild(plus);

        const bonusBall = document.createElement('div');
